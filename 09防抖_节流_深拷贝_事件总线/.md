# 认识防抖和节流

**防抖 (Debouncing)** 和 **节流 (Throttling)** 。它们都是为了限制某个函数在一定时间内被调用的频率，从而减少不必要的计算和操作，提升用户体验和性能。

### 防抖 (Debouncing)

**概念：**

防抖的核心思想是：**在事件被触发后，等待一段时间，如果在这段时间内该事件没有再次被触发，那么才执行对应的函数。如果在这段时间内事件再次被触发，则重新计时。** 就像电梯关门一样，只有当没有人再按开门按钮一段时间后，电梯才会关门。

**应用场景：**

-   **输入框搜索建议 (Autocomplete):** 用户在输入时，如果每次输入都立即发起搜索请求，会给服务器带来很大压力。防抖可以在用户停止输入一段时间后（例如 500ms）再发起请求，减少请求次数。
-   **调整浏览器窗口大小 (Window Resize):** 窗口大小调整事件会频繁触发，执行一些昂贵的操作（如重新计算布局）可能会导致性能问题。防抖可以在用户停止调整大小一段时间后执行一次布局调整。
-   **按钮连续点击:** 防止用户短时间内多次点击按钮导致重复提交或其他不期望的行为。

**实现原理 (JavaScript):**

防抖通常通过一个定时器 (`setTimeout`) 来实现。当事件被触发时，先清除之前的定时器（如果存在），然后设置一个新的定时器。只有当定时器完整地执行完毕后，才会执行目标函数。


**关键点：**

-   **延迟 (delay):** 需要设置一个合适的延迟时间，以平衡用户体验和性能优化。
-   **`clearTimeout()`:** 每次事件触发时都要清除之前的定时器。
-   **`apply()`:** 用于确保函数在正确的上下文中执行，并传递参数。

### 节流 (Throttling)

**概念：**

节流的核心思想是：**在一定时间内，无论事件被触发多少次，都只执行一次对应的函数。** 就像水龙头滴水一样，在固定的时间间隔内，只会滴下一滴水。

**应用场景：**

-   **鼠标移动事件 (Mousemove):** 监听鼠标移动来创建一些动画效果或实时更新位置信息时，`mousemove` 事件会非常频繁地触发。节流可以限制事件处理函数的执行频率，例如每隔 100ms 执行一次。
-   **滚动事件 (Scroll):** 监听滚动事件来加载更多数据或实现一些滚动动画效果时，滚动事件也会频繁触发。节流可以控制加载更多数据的频率，避免一次性加载过多数据导致卡顿。
-   **高频率触发的按钮点击:** 虽然防抖也可以处理，但如果希望在用户持续点击的过程中以固定的频率响应，节流更适合。

**实现原理 (JavaScript):**

节流的实现方式有多种，常见的有使用时间戳和使用定时器。

**使用时间戳：**


**关键点：**

-   **延迟 (delay):** 控制函数执行的频率。
-   **时间戳 (`Date.now()`):** 记录上次函数执行的时间。
-   **定时器 (`setTimeout`):** 在延迟时间后执行函数。

**时间戳 vs. 定时器实现：**

-   **时间戳版本:** 会在第一次事件触发时立即执行函数，之后在固定的时间间隔内执行。
-   **定时器版本:** 不会在第一次事件触发时立即执行，而是在延迟时间后才执行第一次。如果在延迟时间内事件持续触发，则只有第一次触发后的延迟时间到达时才会执行。
-   **可以结合两者实现更精确的节流，例如 leading 和 trailing 选项。**

### 总结

| **特性**   | **防抖 (Debouncing)**           | **节流 (Throttling)**          |
| -------- | ----------------------------- | ---------------------------- |
| **目标**   | 延迟执行，在停止触发后执行一次               | 限制执行频率，在固定时间内最多执行一次          |
| **触发时机** | 在停止触发一段时间后执行                  | 在固定时间间隔内执行                   |
| **应用场景** | 输入框搜索建议、窗口大小调整、按钮连续点击         | 鼠标移动、滚动事件、高频率触发的按钮点击（需要固定响应） |
| **实现方式** | `setTimeout` + `clearTimeout` | 时间戳记录、`setTimeout`           |

# underscore使用
# 防抖函数实现优化
# 节流函数实现优化
# 深拷贝函数的实现
# 事件总线工具实现